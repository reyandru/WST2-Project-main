<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <link rel="stylesheet" href="{% static 'quiz/style.css' %}">
    <title>{{ category.name }} Quiz</title>
    <style>
        .question {
            display: none;
        }
        .timer {
            font-size: 20px;
            color: red;
        }
    </style>
</head>
<body>
    <div class="closeBtn">
        <a class="closeButton" href="{% url 'home' %}">Back to Home</a>
    </div>
    <h1>{{ category.name }} Quiz</h1>
    <form method="post" id="quiz-form">
        {% csrf_token %}
        {% for question in questions %}
            <div class="question" id="question-{{ question.id }}">
                <p>{{ question.text }}</p>
                {% for choice in question.choice_set.all %}
                    <label>
                        <input type="radio" name="{{ question.id }}" value="{{ choice.choice_text }}">
                        {{ choice.choice_text }}
                    </label>
                {% endfor %}
                <div class="timer" id="timer-{{ question.id }}">20</div>
            </div>
        {% endfor %}
        <button type="submit" id="submit-button" style="display:none;">Submit</button>
    </form>

    <script>
        let currentQuestionIndex = 0;
        const questions = document.querySelectorAll('.question');
        const timerElements = document.querySelectorAll('.timer');
        const submitButton = document.getElementById('submit-button');
        
        function showQuestion(index) {
            if (index < questions.length) {
                questions[index].style.display = 'block';
                startTimer(index);
            } else {
                submitButton.style.display = 'block';
            }
        }

        function startTimer(index) {
            let timeLeft = 20;
            const timerElement = document.getElementById('timer-' + (index + 1));

            const timerInterval = setInterval(function() {
                timeLeft--;
                timerElement.textContent = timeLeft;

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    questions[index].style.display = 'none';
                    currentQuestionIndex++;
                    showQuestion(currentQuestionIndex);
                }
            }, 1000);
        }

        for (let i = 1; i < questions.length; i++) {
            questions[i].style.display = 'none';
        }

        showQuestion(currentQuestionIndex);
    </script>
</body>
</html>
